# 坍落度识别系统 - 可视化界面

## 📖 项目简介

这是一个基于深度学习的混凝土坍落度智能识别系统，提供了完整的可视化界面，支持实时识别、批量处理、结果分析等功能。系统采用PyTorch框架，支持多种深度学习模型，为混凝土质量控制提供智能化解决方案。

## ✨ 主要功能

### 🤖 模型配置
- **多模型支持**: ResNet18、ResNet50、VGG16
- **智能权重管理**: 自动加载和管理预训练权重
- **灵活参数设置**: 置信度阈值、批处理大小、图像尺寸等
- **GPU/CPU自适应**: 自动检测并选择最佳计算设备

### 🎯 实时识别
- **图像预处理**: 自动增强、标准化、尺寸调整
- **单张识别**: 快速识别单张图片的坍落度
- **文件夹浏览**: 支持批量浏览和逐一识别
- **结果可视化**: 概率分布、置信度、处理时间等

### 📁 批量处理
- **递归扫描**: 自动扫描文件夹及子文件夹
- **批量推理**: 高效的批处理识别
- **结果保存**: JSON格式结果、标注图片、分析报告
- **进度监控**: 实时显示处理进度和状态

### 📊 结果分析
- **统计图表**: 分类分布、置信度分析等多种图表
- **详细报告**: 完整的识别结果分析报告
- **数据导入**: 支持导入历史识别结果
- **质量评估**: 自动评估识别质量和一致性

## 🚀 快速开始

### 环境要求
- Windows 10/11
- Python 3.7 或更高版本
- 推荐使用GPU（支持CUDA）加速

### 安装步骤

#### 方法一：一键安装（推荐）
```bash
# 1. 双击运行安装脚本
install.py

# 2. 或使用命令行
python install.py
```

#### 方法二：手动安装
```bash
# 1. 安装依赖包
pip install -r requirements.txt

# 2. 创建必要目录
mkdir logs config output temp

# 3. 复制配置文件
copy config\default_config.json config\recognition_config.json
```

### 启动程序

#### 方法一：使用启动脚本（推荐）
```bash
# 双击运行
启动程序.bat
```

#### 方法二：直接运行
```bash
python slump_recognition_gui.py
```

## 📋 使用指南

### 1. 模型配置
1. 打开 **"🤖 模型配置"** 标签页
2. 选择模型类型（ResNet18/ResNet50/VGG16）
3. 设置权重文件路径（默认：`pretrained/resnet18/best_model.pth`）
4. 调整推理参数（置信度阈值、批处理大小等）
5. 点击 **"🔄 加载模型"**

### 2. 实时识别
1. 切换到 **"🎯 实时识别"** 标签页
2. 选择单张图片或图片文件夹
3. 浏览图片（支持键盘导航）
4. 点击 **"🎯 开始识别"** 进行识别
5. 查看识别结果和概率分布

### 3. 批量处理
1. 切换到 **"📁 批量处理"** 标签页
2. 选择输入文件夹和输出文件夹
3. 设置处理选项（保存结果、标注图片、生成报告）
4. 点击 **"▶ 开始批量处理"**
5. 监控处理进度和日志

### 4. 结果分析
1. 切换到 **"📊 结果分析"** 标签页
2. 查看自动生成的统计图表
3. 可导入历史结果文件进行分析
4. 生成详细分析报告

## 📁 目录结构

```
坍落度识别/
├── slump_recognition_gui.py    # 主程序文件
├── models/                     # 模型定义
│   ├── __init__.py
│   ├── model_factory.py        # 模型工厂
│   ├── resnet.py              # ResNet模型
│   ├── vgg.py                 # VGG模型
│   └── README.md
├── pretrained/                # 预训练权重
│   └── resnet18/
│       └── best_model.pth
├── config/                    # 配置文件
│   ├── default_config.json    # 默认配置
│   └── recognition_config.json # 用户配置
├── logs/                      # 日志文件
├── output/                    # 输出目录
├── temp/                      # 临时文件
├── requirements.txt           # 依赖包列表
├── install.py                # 安装脚本
├── 启动程序.bat              # Windows启动脚本
└── README.md                 # 说明文档
```

## ⚙️ 配置说明

### 主要配置参数

| 参数 | 说明 | 默认值 |
|------|------|--------|
| model_name | 模型类型 | "resnet18" |
| weight_path | 权重文件路径 | "pretrained/resnet18/best_model.pth" |
| confidence_threshold | 置信度阈值 | 0.7 |
| batch_size | 批处理大小 | 32 |
| image_size | 输入图像尺寸 | 224 |
| class_names | 分类标签 | ["150-200", "200-250", "250-300", "300+"] |

### 图像预处理参数

| 参数 | 说明 | 默认值 |
|------|------|--------|
| auto_enhance | 自动增强 | true |
| normalize_enabled | 标准化 | true |
| contrast_factor | 对比度因子 | 1.2 |
| sharpness_factor | 锐化因子 | 1.1 |
| brightness_factor | 亮度因子 | 1.05 |

## 🎯 支持的模型

### ResNet18
- **特点**: 轻量级，训练速度快
- **参数量**: ~11M
- **推荐场景**: 快速实验、资源受限环境

### ResNet50
- **特点**: 性能与效率平衡
- **参数量**: ~25M
- **推荐场景**: 生产环境、通用应用

### VGG16
- **特点**: 经典架构，准确率高
- **参数量**: ~138M
- **推荐场景**: 高精度要求的应用

## 📊 输出格式

### 识别结果文件（JSON）
```json
[
  {
    "image_path": "path/to/image.jpg",
    "filename": "image.jpg",
    "predicted_class": 1,
    "predicted_label": "200-250",
    "confidence": 0.95,
    "probabilities": [0.02, 0.95, 0.02, 0.01],
    "timestamp": "2024-01-01T12:00:00"
  }
]
```

### 分析报告（TXT）
- 基本统计信息
- 置信度分布
- 分类分布统计
- 质量评估
- 改进建议
- 详细识别结果

## 🔧 故障排除

### 常见问题

#### 1. 程序无法启动
- 检查Python版本（需要3.7+）
- 运行 `install.py` 安装依赖
- 检查是否有中文路径问题

#### 2. 模型加载失败
- 确认权重文件路径正确
- 检查权重文件是否存在
- 验证模型类型与权重匹配

#### 3. GPU不可用
- 安装CUDA版本的PyTorch
- 检查CUDA驱动版本
- 系统会自动回退到CPU模式

#### 4. 识别结果不准确
- 调整置信度阈值
- 检查图像质量
- 尝试不同的模型

#### 5. 内存不足
- 减少批处理大小
- 降低图像输入尺寸
- 关闭不必要的程序

### 日志文件

程序运行日志保存在 `logs/` 目录下：
- 文件格式: `slump_recognition_YYYYMMDD_HHMMSS.log`
- 包含详细的运行信息和错误信息

## 📈 性能优化

### GPU加速
- 安装CUDA版本的PyTorch
- 确保CUDA驱动兼容
- 合理设置批处理大小

### 批处理优化
- 根据GPU内存调整批处理大小
- 使用多线程进行图像预处理
- 合理设置图像尺寸

### 内存管理
- 及时清理临时文件
- 避免加载过多图像到内存
- 使用适当的数据类型

## 🤝 技术支持

如遇到问题或需要技术支持，请：

1. 查看 `logs/` 目录下的日志文件
2. 检查配置文件是否正确
3. 确认依赖包版本兼容性
4. 提供详细的错误信息和系统环境

## 📄 许可证

本项目仅供学习和研究使用。

## 🔄 更新日志

### v1.0.0 (2024-12-XX)
- 初始版本发布
- 支持ResNet18/50、VGG16模型
- 实现实时识别和批量处理
- 提供完整的结果分析功能
- 支持GPU/CPU自适应
